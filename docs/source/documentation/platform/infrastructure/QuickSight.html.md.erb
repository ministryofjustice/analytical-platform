---
owner_slack: "#data-platform-notifications"
title: QuickSight Interactions with IAM Policies
last_reviewed_on: 2024-03-05
description: >-
  AWS QuickSight is a fast, easy way to get insights from your data.
review_in: 6 months
---

# <%= current_page.data.title %>

## Introduction

We were tasked with understanding how IAM policies interact with QuickSight (QS) 

## QuickSight terms

* Data Source - S3 bucket, Athena, uploaded CSV file etc.
* Dataset - Data Added to QS from a Data source.
* Analyses - Where the data is put into reports
* Dashboard - A published analysis

## QuickSight  Actions

* Anthony accessed QuickSight via the console and thus became an admin user. He invited Brian to access QS originally as a Reader. what did we do around groups etc

* As a admin user the test s3 bucket dev-quicksight-test was was added to the list of S3 buckets in QuckSight Access to AWS services, under Security and permissions. 

![QuickSight S3 access list](../images/quicksight-image1.png "QuickSight S3 access list")

The admin user created a new QS user group to which Brian’s account was added and IAM policies granted to this group. Going forward it may be best to think of this as a per application where collaborating authors could be added whom required access to the data source.

## QS sharing actions
Using Brian’s account with increasing levels of access. 

* Test1 - Account had the minimum level of Access, that of reader with no IAM access granted.
* Test2 - Account set to Author, owner grants shared access to Dataset/Analysis/Dashboard with no IAM access granted.
* Test3 - Account set to Author, no access granted by owner to Dataset/Analysis/Dashboard with no IAM access granted.
* Test4 - Account set to Admin, attempt to access datasource (S3) directly using manifest file with no IAM access granted.
* Test5 - Account set to Author, member of QS user group, attempt to access datasource (S3) directly using manifest file with IAM access granted.
* Test6 - Account set to Author, not a member of QS user group, attempt to access datasource (S3) directly using manifest file with IAM access granted.


![QuickSight test list](../images/quicksight-image2.png "QuickSight test list")

## Athena QS actions

1. Created a new policy for s3 access `poc-quicksight-user-access` granting access to BucketA
2. Created new QS group called user_access
3. Removed Brian’s user from the  QS admin group and added to user_access group 
4. Tested s3 bucket access using this policy and Brian was able to access one S3 BucketA but not BucketB
5. Added BucketB into the policy  `poc-quicksight-user-access` and then could access BucketB via QS 
6. Created new policy for Athena access `poc-quicksight-user-access-athena` assigned to the user access group. So user user_access group has two policies assigned `poc-quicksight-user-access` & `poc-quicksight-user-access-athena`.
7. Brian could create datasets via Athena for both databases/S3 
8. Removed access from the S3 policy `poc-quicksight-user-access` for the BucketB bucket.
9. Tried to create a dataset via Athena Brian could still see both Databases<sup>*</sup> but was unable to retrieve data from the database where access had been removed to the S3.

<sup>*</sup> QS has access to list Athena databases using the IAM policy `poc-quicksight-user-access-athena` which will allow users to see multiple Databases/tables to which they may not have access, <b>BUT</b> they will only be able to retrieve data from  Databases/tables to which they have been granted access via the IAM policy  `poc-quicksight-user-access` .

## QuickSight access flow

![QuickSight acces flow](../images/quicksight-image3.png "QuickSight acces flow")

1. QS must have any S3 bucket to which access is required added to the QS S3 Access list.
2. A IAM policy for access to the S3 Bucket must be created in AWS
3. Within QS individual users or user group be granted access to the IAM policy
4. In addition if Athena access is required a IAM policy to list Databases/Tables must be created in AWS and granted to the QS group. This is generic and not specific to individual databases and does <b>NOT</b> grant access to any data.

## Test user account deletion

Prior to deleting Brian’s email user account, he shared the following dashboards, analyses and datasets with my account (admin). He shared one of each resource with my user as a co-owner, and additionally as a viewer for a dashboard and dataset.


![QuickSight resource deletion](../images/quicksight-image4.png "QuickSight resource deletion")

When deleting Brian’s user, the below options were provided. The option to delete orphaned resources was selected.

![QuickSight delete user](../images/quicksight-image5.png "QuickSight delete user")